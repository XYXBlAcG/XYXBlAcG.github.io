<!DOCTYPE html>
<head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width,initial-scale=1" />
    <!-- <link rel="stylesheet" href="https://pyscript.net/releases/2023.11.2/core.css"/> -->
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/XYXBlAcG/XYXBlAcG.github.io/assets/css/main.css" />
	<noscript><link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/XYXBlAcG/XYXBlAcG.github.io/assets/css/noscript.css" /></noscript>
    <link rel="stylesheet" href="https://pyscript.net/releases/2024.1.1/core.css" />
    <script type="module" src="https://pyscript.net/releases/2024.1.1/core.js"></script>
    <script id="MathJax-script" async src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <title>Easy Math Solver</title>
    <style>
        .hidden {
            display: none;
        }
    </style>
    <script>
        function renderLatex() {
            var latexCode = document.getElementById("latexCode").innerText;
            console.log(latexCode);
            var outputDiv = document.getElementById("latexDiv");
            outputDiv.innerHTML = ""; 
            var latexDiv = document.createElement("latexOut");
            latexDiv.textContent = latexCode;
            MathJax.texReset();
            MathJax.typesetClear();
            MathJax.typesetPromise([latexDiv]).catch(function (err) {
                outputDiv.textContent = err.message;
            });
            outputDiv.appendChild(latexDiv);
        }
    </script>
</head>
<body>
    <div id="wrapper">

        <!-- Header -->
    <header id="header">
        <div class="content">
            <div class="inner">
                <h1>Easy Math Solver</h1>
                <p>author: xyx.</p>
                <p>如果按钮或输入框点不动则脚本正在渲染, 请等待脚本渲染. 手机「可能」暂不支持.</p>
                <!-- <p><del><a href="function_solver_terminal.html">您或许会喜欢终端界面. 但是bug太多没法用.</a></del></p> -->
                <!-- <noscript>你的浏览器不支持JavaScript, 无法运行此实例. </noscript> -->
            </div>
        </div>

        <select name="cal" id="cal-select">
            <option value="">请选择一项...</option>
            <option value="func_sol">解单未知数方程</option>
            <option value="mult_func_sol">解联立方程</option>
            <option value="chem" disabled>化学 (开发难度极高) </option>
            <option value="der" >求导</option>
            <option value="matrix" disabled>解矩阵 (前端开发难度较高) </option>
            <!-- <option value="tri" disabled>三角学 (效率低下, 短期无计划) </option> -->
            <option value="develop" disabled>开发中...</option>
        </select>
    </header>

    <section id="func_sol" class="content hidden">
        <header id="header">
        <input type="text" id="inputer" placeholder="请输入一个方程 (例: (x + 2) * (x - 1) = 0)..." size="60">
        <nav>
            <ul>
                <li><button py-click="runsrc">开始计算</button></li>
                <li><button onclick="renderLatex()">显示Latex</button></li>
                <li><button py-click="clean_content">清除内容</button></li>
                <li><button py-click="helper">我需要帮助</button></li>
                <li><button onClick="window.location.reload()">刷新页面</button></li>
            </ul>
        </nav>
    </header>
        
    </section>

    <section id="mult_func_sol" class="content hidden">
        <header id="header">
            <div id="textboxContainer">
                <input type="text" id="unknown_num" placeholder="请输入方程里出现的未知数, 以空格分隔... " size="80" class="textbox">
                <textarea type="text" id="mul_inputer" placeholder="请输入多个方程, 用逗号分隔 (例: (x + 2) * (y - 1) = 0)..." rows="10" cols="10" class="textbox"></textarea>
            </div>
            <nav>
                <ul>
                    <li><button py-click="runsrc_mult">开始计算</button></li>
                    <li><button onclick="renderLatex()">显示Latex</button></li>
                    <li><button py-click="clean_content">清除内容</button></li>
                    <li><button py-click="helper">我需要帮助</button></li>
                    <li><button onClick="window.location.reload()">刷新页面</button></li>
                </ul>
            </nav>
        </header>
    </section>

    <section id="matrix" class="content hidden">
        <header id="header">
            <div id="textboxContainer">
                <input type="text" id="unknown_num" placeholder="请定义矩阵的名称, 以空格分隔... " size="80" class="textbox">
                <textarea type="text" id="mul_inputer" placeholder="请输入多个矩阵, 与上面的名称相对应, 用分号分隔 ..." rows="10" cols="10" class="textbox"></textarea>
                <input type="text" id="unknown_num" placeholder="请输入矩阵所构成的等式, 只能使用上面定义的矩阵, 使用符号代替矩阵 ... " size="80" class="textbox">
            </div>
            <nav>
                <ul>
                    <li><button py-click="runsrc_mat">开始计算</button></li>
                    <li><button onclick="renderLatex()">显示Latex</button></li>
                    <li><button py-click="clean_content">清除内容</button></li>
                    <li><button py-click="helper">我需要帮助</button></li>
                    <li><button onClick="window.location.reload()">刷新页面</button></li>
                </ul>
            </nav>
        </header>
    </section>

    <section id="chem" class="content hidden">
        <header id="header">
            <nav>
                <ul>
                    <li><a href="./chem_solver.html"><button>化学将在单独的页面里打开.</button></a></li>
                </ul>
            </nav>
        </header>
    </section>

    <section id="der" class="content hidden">
        <header id="header">
            <textarea type="text" id="func_inputer" placeholder="请输入一个单参数函数, 以 x 为参数 (例: 4 / 3 * pi * x ** 3 )..." rows="10" cols="10"></textarea>
            <nav>
                <ul>
                    <li><button py-click="runsrc_der">开始计算</button></li>
                    <li><button onclick="renderLatex()">显示Latex</button></li>
                    <li><button py-click="clean_content">清除内容</button></li>
                    <li><button py-click="helper">我需要帮助</button></li>
                    <li><button onClick="window.location.reload()">刷新页面</button></li>
                </ul>
            </nav>
        </header>
    </section>



    <p><br />解将显示在下面, 以[中括号]括起来, 以逗号分隔.</p>
        <div id="output"></div>
        <div id="latexDiv"></div>
        <div id="latexCode"></div>
    
    <script type="py" src="./function_solver.py"></script>
    <script>
        const contentSelector = document.getElementById('cal-select');
        const contents = document.querySelectorAll('.content');
        contentSelector.addEventListener('change', function() {
            contents.forEach(function(content) {
            if (content.id === contentSelector.value) {
                content.classList.remove('hidden');
            } else {
                content.classList.add('hidden');
            }
            });
        });
    </script>
    <py-config>
        packages = [
            "sympy"
        ]
    </py-config>

    </div>
</body>